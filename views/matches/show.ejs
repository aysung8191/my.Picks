<%- include('../partials/header') %>

<div id="container">
    <div id="header">
        <img id="logo" src="../images/p2logo.jpg" alt="logo">
    </div>
    <div id="content">
        <div id="nav">
            <ul>
                <li><a class="selected" href="/matches" <%- title === 'All Matches' ? 'class="active"' : '' %>>Home</a></li>
                <% if (user) { %>
                <li><a class="selected" href="/logout">Log Out</a></li>
                <% } else { %>
                <li><a class="selected" href="/auth/google">Log In&nbsp;<img src="https://i.imgur.com/FHjYyi0.png"></a></li>
                <% } %>
            </ul>
        </div>
        <div id="main">
            <section id="show-page">
            <div><strong>Matchup:</strong> <%= match.matchup %></div>
            <div><strong>Date:</strong> <%= match.date %></div>
            <div><strong>Current Line:</strong> <%= match.currentLine %></div>
            <div><strong>Opening Line:</strong> <%= match.openingLine %></div>
            <div><strong>Over/Under:</strong> <%= match.overUnder %></div>
            <div><strong>ATS Trends(season):</strong> <%= match.atsTrends %></div>
            <div><strong>Over/Under Trends(season):</strong> <%= match.overUnderTrends %></div>
            <div><strong>Projected Weather:</strong> <%= match.projectedWeather %></div>
            <div><strong>Injured Players:</strong> <%= match.injuredPlayers %></div>
            <br><br>
            <% if (match.comments.length) { %>
            <table>
            <thead>
                <tr>
                <th>Comments</th>
                </tr>
            </thead>
            <tbody>
                <% match.comments.forEach(function(c) { %>
                <tr>
                    <td class="comment-user"><img alt="avatar" src="<%= c.userAvatar %>" referrerpolicy="no-referrer" ><strong><%= c.userName %></strong></td>
                    <td><%= c.content %></td>
                    <td>
                    <% if (user?._id.equals(c.user)) { %>
                        <form action="/comments/<%= c._id %>?_method=DELETE" method="POST">
                            <button type="submit">X</button>
                        </form>
                    <% } %>
                    </td>
                </tr>
                <% }); %>
            </tbody>
            </table>
            <% } else { %>
            <h5>No Comments Yet</h5>
            <% } %>
            <% if (user) { %>
            <br><br>
            <div id="comment-section">
            <h2>Add a Comment</h2><br>
            <form id="add-comment-form" method="POST" action="/matches/<%= match._id %>/comments">
                <label>Comment:</label>
                <textarea name="content"></textarea>
                <input type="submit" value="Submit">
            </form>
            <% } %>
            </div>
            </section>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>